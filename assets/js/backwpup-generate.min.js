jQuery(document).ready((function(o){o("#runningjob").show("slow"),o(".js-backwpup-open-modal").prop("disabled",!0),o(document).trigger("start-backupjob"),backwpup_show_progress=function(){o.ajax({type:"GET",url:ajaxurl,cache:!1,data:{action:"backwpup_working",logpos:o("#logpos").val(),logfile:backwpupApi.logfile,_ajax_nonce:backwpupApi.nonce_generate},dataType:"json",success:function(e){if(0==e&&(o("#runningjob").hide("slow"),o("#backwpup-adminbar-running").remove()),0<e.log_pos&&o("#logpos").val(e.log_pos),""!=e.log_text&&(o("#showworking").append(e.log_text),o("#TB_ajaxContent").scrollTop(15*e.log_pos)),5<e.step_percent){let r=Math.round(100*(e.step_done-1+e.sub_step_percent/100)/e.step_todo);o(".backupgeneration-progress-box .progress-bar .progress-step span").text(r+"%"),o(".backupgeneration-progress-box .progress-bar .progress-step").css("width",parseFloat(r)+"%")}""!=e.last_msg&&o(".backupgeneration-progress-box-step").html(e.on_step+" : "+e.last_msg),1==e.job_done?(o("#abortbutton").remove(),o(".backupgeneration-progress-box .progress-bar").hide(),o("#backwpup-adminbar-running").remove(),o("#backupgeneration-progress-box-title").html(e.last_msg),o(".backupgeneration-progress-box-step").remove(),o(".js-backwpup-open-modal").prop("disabled",!1),window.location.search.includes("backwpupfirstbackup")&&(o("#info_container_2").hide(),o("#first-congratulations").show()),o(document).trigger("backup-complete")):(""!==e.restart_url&&backwpup_trigger_cron(e.restart_url),setTimeout("backwpup_show_progress()",750))},error:function(){console.log("error"),o(".js-backwpup-open-modal").prop("disabled",!1),setTimeout("backwpup_show_progress()",750)}})},backwpup_trigger_cron=function(e){o.ajax({type:"POST",url:e,dataType:"text",cache:!1,processData:!1,timeout:1})},backwpup_show_progress(),o("#showworkingclose").on("click",(function(){let e=o(this).data("bwpup_redirect_url");return e?window.location.href=e:o("#runningjob").hide("slow"),!1})),o(".js-backwpup-abortbutton").on("click",(function(){var e=o(this).data("url");return e&&o.ajax({type:"GET",url:e,success:function(o){},error:function(){console.log("Request failed")}}),!1}))}));