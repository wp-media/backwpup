jQuery(document).ready((function($){async function postToWP(e){return await fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams(e)}).then((e=>e.json()))}function requestWPApi(e,a,t,n="GET",i=null){$.ajax({url:e,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",backwpupApi.nonce)},method:n,data:a,success:function(e){t(e,a)},error:function(e,a){i?i(e,a):console.log(a)}})}function getUrlParameter(e,a=""){let t=new URLSearchParams(window.location.search);return t.has(e)?t.get(e):a}$(".js-backwpup-intonly").on("keydown",(function(e){return!!["Backspace","Delete","ArrowLeft","ArrowRight"].includes(e.code)||!isNaN(Number(e.key))&&"Space"!==e.code})),window.refresh_storage_destinations=function(e,a){$("#destination-"+e).prop("checked",a);const t=[""];$('input[name="storage_destinations[]"]').each((function(){$(this).is(":checked")&&t.push($(this).val())})),requestWPApi(backwpupApi.updatejob,{storage_destinations:t},(function(e){requestWPApi(backwpupApi.storagelistcompact,{},(function(e){$("#backwpup-storage-list-compact-container").html(e)}),"GET",(function(e,a){$("#backwpup-storage-list-compact-container").html(e.responseText)}))}),"POST",(function(e,a){$("#backwpup-storage-list-compact-container").html(e.responseJSON.error)}));0!==$('input[type="checkbox"][name^="onboarding_storage"]:checked').length?$(".js-backwpup-onboarding-submit-form").prop("disabled",!1):$(".js-backwpup-onboarding-submit-form").prop("disabled",!0)},window.gdrive_refresh_authentification=function(){requestWPApi(backwpupApi.cloud_is_authenticated,{cloud_name:"gdrive"},(function(e){$("#gdrive_authenticate_label").html(e)}),"GET")},window.onedrive_refresh_authentification=function(){requestWPApi(backwpupApi.cloud_is_authenticated,{cloud_name:"onedrive"},(function(e){$("#onedrive_authenticate_label").html(e)}),"GET")},window.dropbox_refresh_authentification=function(){requestWPApi(backwpupApi.cloud_is_authenticated,{cloud_name:"dropbox"},(function(e){$("#drobox_authenticate_infos").html(e)}),"GET")},window.update_license=function(){const e=$("#license_action").val(),a={license_action:e,license_instance_key:$("#license_instance_key").val(),license_submit:!0};let t="activate";"activate"===e&&(t="deactivate",a.license_api_key=$("#license_api_key").val(),a.license_product_id=$("#license_product_id").val()),requestWPApi(backwpupApi.license_update,a,(function(e){console.log(e),requestWPApi(backwpupApi.getblock,{block_name:"alerts/info",block_type:"component",block_data:{type:"info",font:"xs",content:e.message}},(function(e){$("#backwpup_message").html(e)}),"POST",(function(e,a){console.log(e.responseJSON.error)})),backwpup_license_refresh(t),200===e.status&&console.log(e)}),"POST",(function(e,a){console.log(e.responseJSON.error),requestWPApi(backwpupApi.getblock,{block_name:"alerts/info",block_type:"component",block_data:{type:"alert",font:"xs",content:e.responseJSON.error}},(function(e){$("#backwpup_message").html(e)}),"POST",(function(e,a){console.log(e.responseJSON.error)}))}))},window.backwpup_license_refresh=function(e){let a="sidebar/license-parts/"+e;console.log(a),requestWPApi(backwpupApi.getblock,{block_name:a,block_type:"children"},(function(e){$("#backwpup_license").html(e),$(".js-backwpup-license_update").on("click",update_license)}),"POST")};const $modal=$("#backwpup-modal"),$sidebar=$("#backwpup-sidebar");function openSidebar(e){$sidebar.find("article").hide(),$sidebar.find("#sidebar-"+e).show(),$("body").addClass("overflow-hidden"),$sidebar.removeClass("translate-x-[450px]")}function closeSidebar(){$("body").removeClass("overflow-hidden"),$sidebar.addClass("translate-x-[450px]")}function openModal(e,a={}){$modal.find("article").hide();let t=$modal.find("#sidebar-"+e);t.show(),a.url&&t.find(".js-backwpup-open-url").attr("data-href",a.url),$("body").addClass("overflow-hidden"),$modal.removeClass("hidden").addClass("flex")}function closeModal(){$("body").removeClass("overflow-hidden"),$modal.addClass("hidden").removeClass("flex")}function initSugarSyncEvents(){$(".js-backwpup-authenticate-sugar-sync").on("click",(function(){let e={cloud_name:"sugarsync",sugaremail:$("#sugaremail").val(),sugarpass:$("#sugarpass").val()};requestWPApi(backwpupApi.authenticate_cloud,e,(function(e){$("#sugarsynclogin").html(e),$("#sugarsync_authenticate_infos").html(""),initSugarSyncEvents()}),"POST",(function(e,a){$("#sugarsync_authenticate_infos").html(e.responseText)}))})),$(".js-backwpup-delete-sugar-sync-auth").on("click",(function(){requestWPApi(backwpupApi.delete_auth_cloud,{cloud_name:"sugarsync"},(function(e){refresh_storage_destinations("SUGARSYNC",e.connected),$("#sugarsynclogin").html(e),initSugarSyncEvents()}),"POST",(function(e,a){alert("Error in cloud configuration")}))})),requestWPApi(backwpupApi.getblock,{block_name:"sidebar/sugar-sync-parts/root-folder",block_type:"children"},(function(e){$("#sugarsyncroot").html(e)}),"POST",(function(e,a){$("#sugarsyncroot").html(e.responseText)}))}function initDropboxEvents(){$(".js-backwpup-test-dropbox-storage").on("click",(function(){const e={cloud_name:"dropbox",dropboxmaxbackups:$("#dropboxmaxbackups").val(),dropboxdir:$("#dropboxdir").val()};let a=$("#dropbbox_code").val();a&&(e.dropbbox_code=a);let t=$("#sandbox_code").val();t&&!a&&(e.sandbox_code=t),requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("DROPBOX",e.connected),dropbox_refresh_authentification(),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("DROPBOX",!1),alert(e.responseJSON.error)}))})),$(".js-backwpup-delete-dropbox-auth").on("click",(function(){const e={cloud_name:"dropbox",delete_auth:!0,dropboxmaxbackups:$("#dropboxmaxbackups").val(),dropboxdir:$("#dropboxdir").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("DROPBOX",e.connected),dropbox_refresh_authentification(),closeSidebar()}),"POST",(function(e,a){alert(e.responseJSON.error)}))}))}function initModalEvent(){$(".js-backwpup-open-modal").on("click",(function(){const e=$(this).data("content");let a={};$(this).data("url")&&(a.url=$(this).data("url")),openModal(e,a)}))}$(".js-backwpup-open-sidebar").on("click",(function(){openSidebar($(this).data("content"))})),$(".js-backwpup-close-sidebar").on("click",closeSidebar),$(".js-backwpup-open-url").on("click",(function(){$(this).data("href")&&(window.location=$(this).data("href"))})),$(".js-backwpup-close-modal").on("click",closeModal),$(".js-backwpup-filter-tables").on("keyup",(function(){const e=$(this).val().toLowerCase();$(".js-backwpup-tables-list label").each((function(){""===e||$(this).find("input").attr("value").toLowerCase().includes(e)?$(this).show():$(this).hide()}))})),$(".js-backwpup-filter-tables").next(".js-backwpup-clear-search").on("click",(function(){$(".js-backwpup-tables-list label").show()}));const $backupsTable=$("#backwpup-backup-history");let isCheckboxListenerInitialized=!1;function showFrequencyFilesFields(e){"weekly"===e&&($(".js-backwpup-frequency-file-show-if-weekly").show(),$(".js-backwpup-frequency-file-show-if-monthly").hide()),"monthly"===e&&($(".js-backwpup-frequency-file-show-if-weekly").hide(),$(".js-backwpup-frequency-file-show-if-monthly").show()),"daily"===e&&($(".js-backwpup-frequency-file-show-if-weekly").hide(),$(".js-backwpup-frequency-file-show-if-monthly").hide())}function showFrequencyTablesFields(e){"weekly"===e&&($(".js-backwpup-frequency-table-show-if-weekly").show(),$(".js-backwpup-frequency-table-show-if-monthly").hide()),"monthly"===e&&($(".js-backwpup-frequency-table-show-if-weekly").hide(),$(".js-backwpup-frequency-table-show-if-monthly").show()),"daily"===e&&($(".js-backwpup-frequency-table-show-if-weekly").hide(),$(".js-backwpup-frequency-table-show-if-monthly").hide())}function initMenuEvent(){$(".js-backwpup-menu").on("click",(function(e){e.stopPropagation();const a=$(this).find(".js-backwpup-menu-content");a.hasClass("hidden")?a.removeClass("hidden"):a.addClass("hidden")})),$("#bulk-actions-apply").prop("disabled",!0),$(".js-backwpup-select-backup").on("click",(function(){const e=$(".js-backwpup-select-backup:checked").length>0;console.log(e),$("#bulk-actions-apply").prop("disabled",!e)}))}function initPaginationEvent(){$(".js-backwpup-table-pagination button").on("click",(function(){let e=$(this).data("page");loadBackupsListingAndPagination(e);let a=new URL(window.location.href);a.searchParams.set("page_num",e),history.pushState({},"",a)}))}function loadBackupsListingAndPagination(e){requestWPApi(backwpupApi.backupslistings,{page:e,length:backwpupApi.backupslistingslength},refreshBackupTable,"POST")}$(".js-backwpup-select-all").on("change",(function(){const e=$(this).prop("checked");$("#bulk-actions-apply").prop("disabled",!e),$backupsTable.find("input[type=checkbox]").prop("checked",e),isCheckboxListenerInitialized||($backupsTable.on("change","input[type=checkbox]",(function(){const e=$backupsTable.find("input[type=checkbox]").length===$backupsTable.find("input[type=checkbox]:checked").length;$(".js-backwpup-select-all").prop("checked",e)})),isCheckboxListenerInitialized=!0)})),showFrequencyFilesFields($(".js-backwpup-frequency-files").val()),showFrequencyTablesFields($(".js-backwpup-frequency-tables").val()),$(".js-backwpup-frequency-files").on("change",(function(){showFrequencyFilesFields($(this).val())})),$(".js-backwpup-frequency-tables").on("change",(function(){showFrequencyTablesFields($(this).val())})),$(document).on("click",(function(){$(".js-backwpup-menu-content").addClass("hidden")})),$(".js-backwpup-toggle-tables").on("click",(function(){postToWP({action:"backwpup_toggle_database",tables:$(this).is(":checked")}).then((e=>{}))})),$(".js-backwpup-clear-search").on("click",(function(){$(this).prev().val("")})),$(".js-backwpup-add-input-button").on("click",(function(){const e=$(this).prev().val().trim();if(""===e)return;$(this).prev().val("");let a=$(".js-backwpup-add-input-values").val().split(",");if(!a.includes(e)){a.push(e),a=[...new Set(a)],$(".js-backwpup-add-input-values").val(a.join(","));if(!$(".js-backwpup-add-input-tags button span").map((function(){return $(this).text()})).get().includes(e)){const a=$(this).parents(".js-backwpup-add-input").find(".js-backwpup-add-input-tag-template button").clone();a.find("span").text(e),a.appendTo(".js-backwpup-add-input-tags")}}})),$(".js-backwpup-add-input-tags").on("click",".js-backwpup-remove-tag",(function(){$(this).remove();let e=$(".js-backwpup-add-input-values").val().split(",");e=e.filter((e=>e!==$(this).data("tag"))),$(".js-backwpup-add-input-values").val(e.join(","))})),$(".js-backwpup-toggle-include button").on("click",(function(){const e=$(this).parents(".js-backwpup-toggle-include"),a=e.find("input[type=checkbox]");a.prop("checked",!a.prop("checked")),a.prop("checked")?(e.find(".js-backwpup-toggle-include-add").addClass("hidden"),e.find(".js-backwpup-toggle-include-remove").removeClass("hidden")):(e.find(".js-backwpup-toggle-include-add").removeClass("hidden"),e.find(".js-backwpup-toggle-include-remove").addClass("hidden"))})),$(".js-backwpup-start-backup").on("click",(function(){requestWPApi(backwpupApi.startbackup,{},(function(e){200===e.status&&setTimeout((function(){window.location.reload()}),500)}),"POST")})),$(".js-backwpup-toggle-exclude").on("change",(function(){const e=$(this).prop("checked");$(this).closest("div").find("button").prop("disabled",!e)})),$(".js-backwpup-toggle-files").on("change",(function(){const e=$(this).prop("checked");let a=$(this).data("job-id");$("#backwpup-files-options").find("button").prop("disabled",!e),requestWPApi(backwpupApi.updatejob,{job_id:a,activ:e,type:"files"},(function(e){$("#backwpup-files-options div p.label-scheduled").html(e.message)}),"POST")})),$(".js-backwpup-toggle-database").on("change",(function(){const e=$(this).prop("checked");let a=$(this).data("job-id");$("#backwpup-database-options").find("button").prop("disabled",!e),requestWPApi(backwpupApi.updatejob,{job_id:a,activ:e,type:"database"},(function(e){$("#backwpup-database-options div p.label-scheduled").html(e.message)}),"POST")})),$(".js-backwpup-test-s3-storage").on("click",(function(){if(""!=$("#s3bucketerror").html())return refresh_storage_destinations("S3",!1),void alert("Error in Bucket Configurations");const e={cloud_name:"s3",s3region:$("#s3region").val(),s3base_url:$("#s3base_url").val(),s3base_region:$("#s3base_region").val(),s3base_version:$("#s3base_version").val(),s3base_signature:$("#s3base_signature").val(),s3accesskey:$("#s3accesskey").val(),s3secretkey:$("#s3secretkey").val(),s3bucket:$("#s3bucket").val(),s3newbucket:$("#s3newbucket").val(),s3dir:$("#s3dir").val(),s3maxbackups:$("#s3maxbackups").val(),s3storageclass:"STANDARD"===$("#s3storageclass").val()?"":$("#s3storageclass").val()};$("#s3base_multipart").prop("checked")&&(e.s3base_multipart=$("#s3base_multipart").val()),$("#s3base_pathstylebucket").prop("checked")&&(e.s3base_pathstylebucket=$("#s3base_pathstylebucket").val()),$("#s3ssencrypt").prop("checked")&&(e.s3ssencrypt=$("#s3ssencrypt").val()),requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("S3",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("S3",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-glacier-storage").on("click",(function(){if(""!=$("#glacierbucketerror").html())return refresh_storage_destinations("GLACIER",!1),void alert("Error in Bucket Configurations");const e={cloud_name:"glacier",glacieraccesskey:$("#glacieraccesskey").val(),glaciersecretkey:$("#glaciersecretkey").val(),glacierregion:$("#glacierregion").val(),glaciervault:$("#glaciervault").val(),glaciermaxbackups:$("#glaciermaxbackups").val(),newvault:$("#newvault").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("GLACIER",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("GLACIER",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-folder-storage").on("click",(function(){const e={cloud_name:"folder",backupdir:$("#backupdir").val(),maxbackups:$("#maxbackups").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("FOLDER",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("FOLDER",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-ftp-storage").on("click",(function(){const e={cloud_name:"ftp",ftphost:$("#ftphost").val(),ftphostport:$("#ftphostport").val(),ftpuser:$("#ftpuser").val(),ftppass:$("#ftppass").val(),ftptimeout:$("#ftptimeout").val(),ftpdir:$("#ftpdir").val(),ftpmaxbackups:$("#ftpmaxbackups").val(),ftpssl:$("#ftpssl").prop("checked"),ftppasv:$("#ftppasv").prop("checked")};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("FTP",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("FTP",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-gdrive-storage").on("click",(function(){const e={cloud_name:"gdrive",gdriveusetrash:$("#gdriveusetrash").prop("checked"),gdrivemaxbackups:$("#gdrivemaxbackups").val(),gdrivedir:$("#gdrivedir").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("GDRIVE",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("GDRIVE",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-delete-hidrive-auth").on("click",(function(){const e={cloud_name:"hidrive",hidrive_delete_authorization:!0,hidrive_max_backups:$("#hidrive_max_backups").val(),hidrive_destination_folder:$("#hidrive_destination_folder").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){closeSidebar()}),"POST",(function(e,a){alert("Error in cloud configuration")}))})),$(".js-backwpup-test-hidrive-storage").on("click",(function(){const e={cloud_name:"hidrive",hidrive_max_backups:$("#hidrive_max_backups").val(),hidrive_destination_folder:$("#hidrive_destination_folder").val()};let a=$("#hidrive_authorization_code").val();a&&(e.hidrive_authorization_code=a),requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("HIDRIVE",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("HIDRIVE",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-onedrive-storage").on("click",(function(){const e={cloud_name:"onedrive",onedrivedir:$("#onedrivedir").val(),onedrivemaxbackups:$("#onedrivemaxbackups").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("ONEDRIVE",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("ONEDRIVE",!0),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-sugar-sync-storage").on("click",(function(){const e={cloud_name:"sugarsync",sugardir:$("#sugardir").val(),sugarmaxbackups:$("#sugarmaxbackups").val(),sugarroot:$("#sugarroot").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("SUGARSYNC",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("SUGARSYNC",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-rackspace-cloud-storage").on("click",(function(){const e={cloud_name:"rsc",newrsccontainer:$("#newrsccontainer").val(),rscdir:$("#rscdir").val(),rscmaxbackups:$("#rscmaxbackups").val(),rsccontainer:$("#rsccontainer").val(),rscusername:$("#rscusername").val(),rscapikey:$("#rscapikey").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("RSC",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("RSC",!1),alert("Error in cloud configuration")}))})),$(".js-backwpup-test-msazure-storage").click((function(){const e={cloud_name:"msazure",msazureaccname:$("#msazureaccname").val(),msazurekey:$("#msazurekey").val(),msazurecontainer:$("#msazurecontainer").val(),newmsazurecontainer:$("#newmsazurecontainer").val(),msazuredir:$("#msazuredir").val(),msazuremaxbackups:$("#msazuremaxbackups").val()};requestWPApi(backwpupApi.cloudsaveandtest,e,(function(e){refresh_storage_destinations("MSAZURE",e.connected),closeSidebar()}),"POST",(function(e,a){refresh_storage_destinations("MSAZURE",!1),alert("Error in cloud configuration")}))}));const $onboardingSteps=$("#backwpup-onboarding-steps"),$onboardingPanes=$("#backwpup-onboarding-panes"),lineStyles="before:bg-secondary-base",circleActiveStyles="bg-secondary-base after:absolute after:z-10 after:inset after:w-12 after:h-12 after:border-secondary-base after:border after:rounded-full after:animate-pulse",circleReachedStyles="bg-secondary-base";function init_network_authentication(){const e=$(".js-backwpup-network-authentication-method").val();$("#network-"+e+"-authentication").show()}function verifyOnboardingStep1(){const e=!$(".js-backwpup-onboarding-toggle-files").prop("checked"),a=!$(".js-backwpup-onboarding-toggle-database").prop("checked");e&&a?$(".js-backwpup-onboarding-step-2").prop("disabled",!0):$(".js-backwpup-onboarding-step-2").prop("disabled",!1)}function refreshBackupTable(e,a){if(e.success&&e.data){var t=e.data,n=jQuery.parseHTML(t);jQuery("#backwpup-backup-history tbody").html(n),window.BWU.downloader.init(),initMenuEvent(),initModalEvent();let i=Math.ceil(jQuery('input[name="nb_backups"]').val()/a.length);requestWPApi(backwpupApi.backupspagination,{page:a.page,max_pages:i},refreshPagination,"POST")}}function refreshPagination(e){if(e.success&&e.data){var a=e.data,t=jQuery.parseHTML(a);jQuery("#backwpup-pagination").html(t),initPaginationEvent()}}function isGenerateJsIncluded(){const e=document.querySelectorAll("script");for(let a of e)if(a.src.includes("backwpup-generate.js")||a.src.includes("backwpup-generate.min.js"))return!0;return!1}function startBackupProcess(){isGenerateJsIncluded()?$(".progress-bar").on("hide",(function(){console.log(".progress-bar is being hidden")})):requestWPApi(backwpupApi.startbackup,{},(function(e){200===e.status&&setTimeout((function(){"#dbbackup"!==window.location.hash&&window.location.reload()}),500)}),"POST")}$(".js-backwpup-onboarding-step-1").on("click",(function(){$onboardingPanes.find("article").removeClass("flex").addClass("hidden"),$onboardingPanes.find("article[data-step=1]").removeClass("hidden").addClass("flex"),$onboardingSteps.find("article[data-step=2]").removeClass(lineStyles).find("div:first-child").removeClass(circleActiveStyles),closeSidebar()})),$(".js-backwpup-onboarding-step-2").on("click",(function(){$onboardingPanes.find("article").removeClass("flex").addClass("hidden"),$onboardingPanes.find("article[data-step=2]").removeClass("hidden").addClass("flex"),$onboardingSteps.find("article[data-step=2]").addClass(lineStyles).find("div:first-child").addClass(circleActiveStyles),$onboardingSteps.find("article[data-step=1] div:first-child").removeClass(circleActiveStyles).addClass(circleReachedStyles),$onboardingSteps.find("article[data-step=3]").removeClass(lineStyles).find("div:first-child").removeClass(circleActiveStyles),closeSidebar()})),$(".js-backwpup-onboarding-step-3").on("click",(function(){$onboardingPanes.find("article").removeClass("flex").addClass("hidden"),$onboardingPanes.find("article[data-step=3]").removeClass("hidden").addClass("flex"),$onboardingSteps.find("article[data-step=3]").addClass(lineStyles).find("div:first-child").addClass(circleActiveStyles),$onboardingSteps.find("article[data-step=2] div:first-child").removeClass(circleActiveStyles).addClass(circleReachedStyles),closeSidebar()})),$(".js-backwpup-onboarding-submit-form").on("click",(function(){0!==$('input[type="checkbox"][name^="onboarding_storage"]:checked').length&&$("#backwpup-onboarding-form").submit()})),$(".js-backwpup-toggle-storage").on("click",(function(){openSidebar($(this).data("content"))})),$(".js-backwpup-gdrive-reauthenticate").on("click",(function(){openModal("dialog"),$(".js-backwpup-refresh-authentification").data("trigger","gdrive_refresh_authentification"),window.open($(this).data("url"),"_blank")})),$(".js-backwpup-onedrive-reauthenticate").on("click",(function(){openModal("dialog"),$(".js-backwpup-refresh-authentification").data("trigger","onedrive_refresh_authentification"),window.open($(this).data("url"),"_blank")})),$(".js-backwpup-refresh-authentification").on("click",(function(){let trigger=$(this).data("trigger");"function"==typeof window[trigger]?window[trigger]():eval(trigger),closeModal()})),$(".js-backwpup-modal-and-focus").on("click",(function(){openModal("dialog");const e=$(this).data("id-focus-after");$(".js-backwpup-refresh-authentification").data("trigger",'$("#'+e+'").focus()'),window.open($(this).data("url"),"_blank")})),$(".js-backwpup-gdrive-connect-api").on("click",(function(){const e=$(this).closest("details");let a={backwpup_cfg_googleclientsecret:{value:$("#backwpup_cfg_googleclientsecret").val(),secure:!0},backwpup_cfg_googleclientid:{value:$("#backwpup_cfg_googleclientid").val(),secure:!1}};requestWPApi(backwpupApi.save_site_option,a,(function(a){$("#gdrive_authenticate_infos").html(a.message),e.removeAttr("open")}),"POST",(function(e,a){$("#gdrive_authenticate_infos").html("Error")}))})),$(".js-backwpup-one-drive-connect-api").on("click",(function(){const e=$(this).closest("details");let a={backwpup_cfg_onedriveclientsecret:{value:$("#backwpup_cfg_onedriveclientsecret").val(),secure:!0},backwpup_cfg_onedriveclientid:{value:$("#backwpup_cfg_onedriveclientid").val(),secure:!1}};requestWPApi(backwpupApi.save_site_option,a,(function(a){$("#onedrive_authenticate_infos").html(a.message),e.removeAttr("open")}),"POST",(function(e,a){$("#onedrive_authenticate_infos").html("Error")}))})),$(".js-backwpup-test-storage").on("click",(function(){const e={action:"backwpup_test_storage",storage:$(this).data("storage")};postToWP(e).then((a=>{$(`input[name=storage_${e.storage}]`).prop("checked",!0);$(this).closest("#backwpup-sidebar").length>0||closeSidebar()})),$(`input[name=storage_${e.storage}]`).prop("checked",!0);const a=$(this).closest("#backwpup-sidebar").length>0;"backwpuponboarding"===new URLSearchParams(window.location.search).get("page")?closeSidebar():a?openSidebar("storages"):closeSidebar()})),init_network_authentication(),$(".js-backwpup-network-authentication-method").on("change",(function(){$("#network-authentications").children("div").hide(),init_network_authentication()})),$(".js-backwpup-sidebar-submit-form").on("click",(function(){$(this).siblings("div").children().submit()})),$(".js-backwpup-onboarding-toggle-files").on("change",(function(){const e=$(this).prop("checked");$(".onboarding-advanced-files-setings").prop("disabled",!e),$(".onboarding-files-frequency").prop("disabled",!e),$(".onboarding-files-frequency-settings").prop("disabled",!e),verifyOnboardingStep1()})),$(".js-backwpup-onboarding-toggle-database").on("change",(function(){const e=$(this).prop("checked");$(".onboarding-advanced-database-setings").prop("disabled",!e),$(".onboarding-database-frequency").prop("disabled",!e),$(".onboarding-database-frequency-settings").prop("disabled",!e),verifyOnboardingStep1()})),$(".js-backwpup-onboarding-files-frequency").on("change",(function(){if($("#sidebar-frequency-files")){let e=$("#sidebar-frequency-files").find("select[name='frequency']");e.val(this.value),e.trigger("change")}})),$(".js-backwpup-onboarding-database-frequency").on("change",(function(){if($("#sidebar-frequency-tables")){let e=$("#sidebar-frequency-tables").find("select[name='frequency']");e.val(this.value),e.trigger("change")}})),jQuery("#backwpup-backup-history tbody").length>0&&loadBackupsListingAndPagination(getUrlParameter("page_num",1)),initModalEvent(),initSugarSyncEvents(),initDropboxEvents(),$(".save_database_settings").on("click",(function(){const e=$(this).closest("article"),a={frequency:e.find("select[name='frequency']").val(),start_time:e.find("input[name='start_time']").val()};requestWPApi(backwpupApi.save_database_settings,a,(function(e){if(200===e.status){if($("#backwpup-database-options div p.label-scheduled").html(e.next_backup),$("#backwpup-onboarding-panes")){let e=$("#backwpup-onboarding-panes").find("select[name='database_frequency']"),a=$("#sidebar-frequency-tables-pro").find("select[name='frequency']");e.val(a.val())}closeSidebar()}}),"POST")})),$(".save_files_settings").on("click",(function(){const e=$(this).closest("article"),a={frequency:e.find("select[name='frequency']").val(),start_time:e.find("input[name='start_time']").val()};requestWPApi(backwpupApi.save_files_settings,a,(function(e){if(200===e.status){if($("#backwpup-files-options div p.label-scheduled").html(e.next_backup),$("#backwpup-onboarding-panes")){let e=$("#backwpup-onboarding-panes").find("select[name='files_frequency']"),a=$("#sidebar-frequency-files-pro").find("select[name='frequency']");e.val(a.val())}closeSidebar()}}),"POST")})),$("#bulk-actions-apply").on("click",(function(){const e=$(this).data("action"),a=$backupsTable.find("input[type=checkbox]:checked").map((function(){return{dataset:$(this).data("delete")}})).get();requestWPApi(backwpupApi.backups_bulk_actions,{action:e,backups:a},(function(e){loadBackupsListingAndPagination(getUrlParameter("page_num",1))}),"POST"),$(".js-backwpup-select-all").prop("checked",!1)})),$("#bulk-actions-select").on("change",(function(){const e=$(this).val();$("#bulk-actions-apply").data("action",e)})),$("#save-excluded-tables").on("click",(function(){const e=$(".js-backwpup-tables-list input[type='checkbox']"),a=$(this).closest("article"),t=[];e.each((function(){$(this).is(":checked")&&t.push($(this).val())}));const n=a.find("input[type='hidden']"),i=[];n.each((function(){i.push({name:$(this).attr("name"),value:$(this).val()})})),t.forEach((function(e){i.push({name:"tabledb[]",value:e})}));const s=$.param(i);requestWPApi(backwpupApi.save_excluded_tables,s,(function(e){200===e.status&&closeSidebar()}),"POST")})),$(".js-backwpup-license_update").on("click",update_license),$(".file-exclusions-submit").on("click",(function(e){const a=$(this).closest("article").find("input"),t={};function n(e,a){e.endsWith("[]")?(t[e]||(t[e]=[]),a&&t[e].push(a)):t[e]=a}a.each((function(){$(this).is(":checkbox")?$(this).is(":checked")&&n($(this).attr("name"),$(this).val()):n($(this).attr("name"),$(this).val())})),$('[id^="sidebar-exclude-files-"]').each((function(){$(this).find("input").each((function(){$(this).is(":checkbox")?$(this).is(":checked")&&n($(this).attr("name"),$(this).val()):n($(this).attr("name"),$(this).val())}))}));const i=$.param(t);requestWPApi(backwpupApi.save_file_exclusions,i,(function(e){200===e.status&&closeSidebar()}),"POST")})),window.location.search.includes("backwpupfirstbackup")&&startBackupProcess();var buyProMenuItem=$('#toplevel_page_backwpup ul li a[href="admin.php?page=buypro"]');buyProMenuItem.length&&(buyProMenuItem.attr("href","https://backwpup.com/#buy"),buyProMenuItem.attr("target","_blank"),buyProMenuItem.css({color:"#3ac495","font-weight":"bold"}));var DocsMenuItem=$('#toplevel_page_backwpup ul li a[href="admin.php?page=docs"]');DocsMenuItem.length&&(DocsMenuItem.attr("href","https://backwpup.com/docs/"),DocsMenuItem.attr("target","_blank"))})),function(e){var a=e.fn.hide;e.fn.hide=function(){return this.trigger("hide"),a.apply(this,arguments)}}(jQuery);